function i(){throw new Error("Cycle detected")}function t(){if(n>1)n--;else{for(var o,f=!1;void 0!==r;){var S=r;for(r=void 0,s++;void 0!==S;){var x=S.o;if(S.o=void 0,S.f&=-3,!(8&S.f)&&d(S))try{S.c()}catch(S){f||(o=S,f=!0)}S=x}}if(s=0,n--,f)throw o}}function h(o){if(n>0)return o();n++;try{return o()}finally{t()}}var o=void 0,r=void 0,n=0,s=0,f=0;function v(r){if(void 0!==o){var n=r.n;if(void 0===n||n.t!==o)return o.s=n={i:0,S:r,p:void 0,n:o.s,t:o,e:void 0,x:void 0,r:n},r.n=n,32&o.f&&r.S(n),n;if(-1===n.i)return n.i=0,void 0!==n.p&&(n.p.n=n.n,void 0!==n.n&&(n.n.p=n.p),n.p=void 0,n.n=o.s,o.s.p=n,o.s=n),n}}function e(o){this.v=o,this.i=0,this.n=void 0,this.t=void 0}function u(o){return new e(o)}function d(o){for(var r=o.s;void 0!==r;r=r.n)if(r.S.i!==r.i||!r.S.h()||r.S.i!==r.i)return!0;return!1}function c(o){for(var r=o.s;void 0!==r;r=r.n){var n=r.S.n;void 0!==n&&(r.r=n),r.S.n=r,r.i=-1}}function a(o){for(var r=o.s,n=void 0;void 0!==r;){var s=r.n;-1===r.i?(r.S.U(r),r.n=void 0):(void 0!==n&&(n.p=r),r.p=void 0,r.n=n,n=r),r.S.n=r.r,void 0!==r.r&&(r.r=void 0),r=s}o.s=n}function l(o){e.call(this,void 0),this.x=o,this.s=void 0,this.g=f-1,this.f=4}function w(o){return new l(o)}function y(r){var s=r.u;if(r.u=void 0,"function"==typeof s){n++;var f=o;o=void 0;try{s()}catch(t){throw r.f&=-2,r.f|=8,_(r),t}finally{o=f,t()}}}function _(o){for(var r=o.s;void 0!==r;r=r.n)r.S.U(r);o.x=void 0,o.s=void 0,y(o)}function g(r){if(o!==this)throw new Error("Out-of-order effect");a(this),o=r,this.f&=-2,8&this.f&&_(this),t()}function p(o){this.x=o,this.u=void 0,this.s=void 0,this.o=void 0,this.f=32}function b(o){var r=new p(o);return r.c(),r.d.bind(r)}e.prototype.h=function(){return!0},e.prototype.S=function(o){this.t!==o&&void 0===o.e&&(o.x=this.t,void 0!==this.t&&(this.t.e=o),this.t=o)},e.prototype.U=function(o){var r=o.e,n=o.x;void 0!==r&&(r.x=n,o.e=void 0),void 0!==n&&(n.e=r,o.x=void 0),o===this.t&&(this.t=n)},e.prototype.subscribe=function(o){var r=this;return b((function(){var n=r.value,s=32&this.f;this.f&=-33;try{o(n)}finally{this.f|=s}}))},e.prototype.valueOf=function(){return this.value},e.prototype.toString=function(){return this.value+""},e.prototype.peek=function(){return this.v},Object.defineProperty(e.prototype,"value",{get:function(){var o=v(this);return void 0!==o&&(o.i=this.i),this.v},set:function(o){if(o!==this.v){s>100&&i(),this.v=o,this.i++,f++,n++;try{for(var r=this.t;void 0!==r;r=r.x)r.t.N()}finally{t()}}}}),(l.prototype=new e).h=function(){if(this.f&=-3,1&this.f)return!1;if(32==(36&this.f))return!0;if(this.f&=-5,this.g===f)return!0;if(this.g=f,this.f|=1,this.i>0&&!d(this))return this.f&=-2,!0;var r=o;try{c(this),o=this;var n=this.x();(16&this.f||this.v!==n||0===this.i)&&(this.v=n,this.f&=-17,this.i++)}catch(r){this.v=r,this.f|=16,this.i++}return o=r,a(this),this.f&=-2,!0},l.prototype.S=function(o){if(void 0===this.t){this.f|=36;for(var r=this.s;void 0!==r;r=r.n)r.S.S(r)}e.prototype.S.call(this,o)},l.prototype.U=function(o){if(e.prototype.U.call(this,o),void 0===this.t){this.f&=-33;for(var r=this.s;void 0!==r;r=r.n)r.S.U(r)}},l.prototype.N=function(){if(!(2&this.f)){this.f|=6;for(var o=this.t;void 0!==o;o=o.x)o.t.N()}},l.prototype.peek=function(){if(this.h()||i(),16&this.f)throw this.v;return this.v},Object.defineProperty(l.prototype,"value",{get:function(){1&this.f&&i();var o=v(this);if(this.h(),void 0!==o&&(o.i=this.i),16&this.f)throw this.v;return this.v}}),p.prototype.c=function(){var o=this.S();try{8&this.f||void 0===this.x||(this.u=this.x())}finally{o()}},p.prototype.S=function(){1&this.f&&i(),this.f|=1,this.f&=-9,y(this),c(this),n++;var r=o;return o=this,g.bind(this,r)},p.prototype.N=function(){2&this.f||(this.f|=2,this.o=r,r=this)},p.prototype.d=function(){this.f|=8,1&this.f||_(this)};export{e as Signal,h as batch,w as computed,b as effect,u as signal};